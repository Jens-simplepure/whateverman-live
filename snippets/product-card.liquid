{% comment %}
  Renders a product card
  Accepts:
  - product_card_product: The product object
{% endcomment %}

<div class="product-card">
  <a href="{{ product_card_product.url }}" class="product-card__link">
    
    <div class="product-card__image">
      {% if product_card_product.featured_image %}
        <img
          src="{{ product_card_product.featured_image | image_url: width: 800 }}"
          alt="{{ product_card_product.featured_image.alt | escape }}"
          loading="lazy"
          width="800"
          height="800"
          class="product-card__img-main"
        >
        
        {% if product_card_product.images[1] != blank %}
          <img 
            src="{{ product_card_product.images[1] | image_url: width: 800 }}"
            alt="{{ product_card_product.images[1].alt | escape }}"
            loading="lazy"
            class="product-card__img-hover"
          >
        {% endif %}
      {% else %}
        {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
      {% endif %}

      {%- assign thirty_days_ago = 'now' | date: '%s' | plus: 0 | minus: 2592000 -%}
      {%- assign product_date = product_card_product.created_at | date: '%s' | plus: 0 -%}

      {% if product_card_product.available == false %}
        <span class="product-card__badge product-card__badge--sold-out">Sold Out</span>
      {% elsif product_card_product.compare_at_price > product_card_product.price %}
        <span class="product-card__badge product-card__badge--sale">Sale</span>
      {% elsif product_card_product.tags contains 'New' or product_date > thirty_days_ago %}
        <span class="product-card__badge">New</span>
      {% endif %}
    </div>

    <div class="product-card__content">
      <h3 class="product-card__title">{{ product_card_product.title }}</h3>
      
      <div class="product-card__price">
        {% if product_card_product.compare_at_price > product_card_product.price %}
          <span style="text-decoration: line-through; color: #666; margin-right:6px; font-size:0.9em;">
            {{ product_card_product.compare_at_price | money }}
          </span>
          <span style="color: var(--color-accent); font-weight:bold;">
            {{ product_card_product.price | money }}
          </span>
        {% else %}
          <span>{{ product_card_product.price | money }}</span>
        {% endif %}
      </div>
    </div>
  </a>
</div>

<style>
  /* Lokale Styles für den Bild-Hover Effekt */
  .product-card__image {
    position: relative;
    overflow: hidden;
    background: #111;
  }

  .product-card__img-main {
    transition: opacity 0.4s ease;
    width: 100%;
    height: auto;
    display: block;
  }

  .product-card__img-hover {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: 2;
  }

  /* Beim Hover über die Karte das 2. Bild einblenden */
  .product-card:hover .product-card__img-hover {
    opacity: 1;
  }
  
  /* Fallback SVG Style */
  .placeholder-svg {
    width: 100%;
    height: 100%;
    background-color: #222;
    fill: #444;
  }
</style>