{%- style -%}
  .site-header { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: var(--color-background); border-bottom: 1px solid rgba(255, 255, 255, 0.1); transition: all 0.3s ease; }
  .site-header.is-scrolled { background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(10px); }
  .site-header.is-hidden { transform: translateY(-100%); }
  .header__wrapper { display: flex; align-items: center; justify-content: space-between; height: var(--header-height); padding: 0 1rem; max-width: var(--container-width); margin: 0 auto; position: relative; }
  @media (min-width: 768px) { .header__wrapper { padding: 0 2rem; } }
  
  .header__nav { display: none; }
  @media (min-width: 1024px) { .header__nav { display: flex; align-items: center; gap: 2rem; } }
  
  /* Parent Nav Item */
  .header__nav-item { position: static; height: 100%; display: flex; align-items: center; }
  
  .header__nav-link {
    position: relative; font-family: 'Bebas Neue', sans-serif; font-size: 1.125rem; letter-spacing: 0.05em; color: var(--color-text); text-transform: uppercase; text-decoration: none; transition: all 0.3s ease;
    height: 100%; display: flex; align-items: center; padding: 0 5px; /* Padding for hover area */
  }
  .header__nav-link:hover { color: var(--color-primary); text-shadow: var(--glow-primary); }
  .header__nav-link::after { content: ''; position: absolute; bottom: 20px; left: 0; width: 100%; height: 2px; background: var(--color-primary); transform: scaleX(0); transform-origin: right; transition: transform 0.3s ease; }
  .header__nav-link:hover::after { transform: scaleX(1); transform-origin: left; box-shadow: 0 0 10px var(--color-primary); }
  
  .header__logo { position: static; order: 0; }
  @media (min-width: 1024px) { .header__logo { position: absolute; left: 50%; transform: translateX(-50%); } }
  .header__logo-link { display: block; transition: all 0.3s ease; }
  .header__logo-link:hover { filter: drop-shadow(0 0 10px var(--color-primary)); }
  .header__logo-text { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; letter-spacing: 0.1em; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
  @media (min-width: 768px) { .header__logo-text { font-size: 2rem; } }
  
  .header__icons { display: flex; align-items: center; gap: 0.5rem; }
  @media (min-width: 768px) { .header__icons { gap: 1.5rem; } }
  .header__text-link { position: relative; display: none; align-items: center; background: transparent; border: none; font-family: 'Bebas Neue', sans-serif; font-size: 0.875rem; letter-spacing: 0.05em; color: var(--color-text); text-transform: uppercase; cursor: pointer; transition: all 0.3s ease; padding: 0.5rem 0; }
  @media (min-width: 480px) { .header__text-link { display: flex; font-size: 1rem; } }
  @media (min-width: 768px) { .header__text-link { font-size: 1.125rem; } }
  .header__text-link:hover { color: var(--color-primary); text-shadow: var(--glow-primary); }
  .header__cart-count { display: inline-flex; align-items: center; justify-content: center; min-width: 18px; height: 18px; padding: 0 4px; background: var(--color-primary); color: var(--color-background); font-size: 0.7rem; font-weight: 600; border-radius: 50%; margin-left: 0.25rem; }
  
  .header__mobile-toggle { display: flex; flex-direction: column; gap: 4px; background: transparent; border: none; cursor: pointer; padding: 6px; margin-left: 0.25rem; }
  @media (min-width: 768px) { .header__mobile-toggle { gap: 5px; padding: 8px; } }
  @media (min-width: 1024px) { .header__mobile-toggle { display: none; } }
  .header__mobile-toggle span { display: block; width: 20px; height: 2px; background: var(--color-text); transition: all 0.3s ease; }
  @media (min-width: 768px) { .header__mobile-toggle span { width: 24px; } }
  
  .mobile-menu { position: fixed; top: var(--header-height); left: 0; right: 0; bottom: 0; background: var(--color-background); transform: translateX(-100%); transition: transform 0.3s ease; z-index: 999; padding: 1.5rem; overflow-y: auto; }
  @media (min-width: 768px) { .mobile-menu { padding: 2rem; } }
  .mobile-menu.is-open { transform: translateX(0); }
  .mobile-menu__nav { display: flex; flex-direction: column; gap: 1.25rem; }
  .mobile-menu__link { font-family: 'Bebas Neue', sans-serif; font-size: 1.5rem; letter-spacing: 0.05em; color: var(--color-text); text-transform: uppercase; text-decoration: none; transition: all 0.3s ease; }
  @media (min-width: 768px) { .mobile-menu__link { font-size: 2rem; } }
  .mobile-menu__link:hover { color: var(--color-primary); transform: translateX(10px); }
  .mobile-menu__icons { display: flex; gap: 1rem; padding-top: 1.5rem; margin-top: 1.5rem; border-top: 1px solid rgba(255, 255, 255, 0.1); }
  @media (min-width: 480px) { .mobile-menu__icons { display: none; } }
  .mobile-menu__icon-link { display: flex; align-items: center; gap: 0.5rem; color: var(--color-text); font-family: 'Bebas Neue', sans-serif; font-size: 1rem; text-transform: uppercase; text-decoration: none; transition: all 0.3s ease; }

  /* MEGA MENU STYLES */
  .mega-menu {
    opacity: 0; visibility: hidden; transform: translateY(10px); transition: all 0.2s cubic-bezier(0.165, 0.84, 0.44, 1);
    position: fixed; top: var(--header-height); left: 0; width: 100%;
    background: #ffffff; border-top: 1px solid rgba(0,0,0,0.05); box-shadow: 0 20px 40px rgba(0,0,0,0.05);
    z-index: 990; color: #000;
  }
  .header__nav-item:hover .mega-menu { opacity: 1; visibility: visible; transform: translateY(0); }
  .mega-menu__wrapper { max-width: var(--container-width); margin: 0 auto; padding: 50px 40px; display: grid; grid-template-columns: 1fr 300px; gap: 60px; }
  .mega-menu__cols { display: flex; flex-wrap: wrap; gap: 60px; }
  .mega-menu__col { min-width: 160px; }
  .mega-menu__heading { display: block; font-family: 'Bebas Neue', sans-serif; font-size: 1.25rem; color: #000; margin-bottom: 20px; text-decoration: none; letter-spacing: 0.05em; }
  .mega-menu__list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }
  .mega-menu__sublink { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #555; text-decoration: none; font-size: 0.95rem; transition: color 0.2s; display: block; }
  .mega-menu__sublink:hover { color: #000; text-decoration: underline; }
  .mega-menu__promo { border-left: 1px solid #f0f0f0; padding-left: 60px; display: flex; flex-direction: column; justify-content: flex-start; }
  .promo-image { width: 100%; aspect-ratio: 4/5; background: #f4f4f4; border-radius: 4px; overflow: hidden; margin-bottom: 15px; }
  .promo-image img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
  .mega-menu__promo:hover img { transform: scale(1.05); }
  .promo-text { font-family: 'Bebas Neue', sans-serif; color: #000; font-size: 1.1rem; }
{%- endstyle -%}

<header class="site-header" data-sticky="{{ settings.header_sticky }}">
  <div class="header__wrapper">
    
    <nav class="header__nav header__nav--left">
      {% for link in linklists.main-menu.links %}
        {% if forloop.index <= 3 %}
          <div class="header__nav-item">
            <a href="{{ link.url }}" class="header__nav-link">
              {{ link.title }}
              {% if link.title contains 'New' %}<span class="badge badge-new" style="margin-left:5px; font-size:0.7em; background:var(--color-primary); color:#000; padding:2px 4px; border-radius:2px;">NEW</span>{% endif %}
            </a>
            
            {% comment %} --- MEGA MENU START --- {% endcomment %}
            {% if link.links != blank %}
              <div class="mega-menu">
                <div class="mega-menu__wrapper">
                  <div class="mega-menu__cols">
                    {% for childlink in link.links %}
                      <div class="mega-menu__col">
                        <a href="{{ childlink.url }}" class="mega-menu__heading">{{ childlink.title }}</a>
                        <ul class="mega-menu__list">
                          {% for grandchild in childlink.links %}
                            <li><a href="{{ grandchild.url }}" class="mega-menu__sublink">{{ grandchild.title }}</a></li>
                          {% endfor %}
                        </ul>
                      </div>
                    {% endfor %}
                  </div>
                  <div class="mega-menu__promo">
                    <a href="{{ link.url }}" style="text-decoration:none;">
                      <div class="promo-image">
                         {% if collections['new-arrivals'].image %}
                           <img src="{{ collections['new-arrivals'].image | image_url: width: 400 }}" alt="New">
                         {% else %}
                           <div style="height:100%; width:100%; background:#eee; display:flex; align-items:center; justify-content:center; color:#999;">Promo</div>
                         {% endif %}
                      </div>
                      <span class="promo-text">Shop {{ link.title }} &rarr;</span>
                    </a>
                  </div>
                </div>
              </div>
            {% endif %}
            {% comment %} --- MEGA MENU END --- {% endcomment %}
            
          </div>
        {% endif %}
      {% endfor %}
    </nav>
    
    <div class="header__logo">
      <a href="/" class="header__logo-link">
        {% if settings.logo != blank %}
          <img src="{{ settings.logo | image_url: width: settings.logo_width }}" alt="{{ shop.name }}" width="{{ settings.logo_width }}" loading="eager">
        {% else %}
          <span class="header__logo-text">{{ shop.name }}</span>
        {% endif %}
      </a>
    </div>
    
    <div class="header__icons">
      <nav class="header__nav header__nav--right">
        {% for link in linklists.main-menu.links %}
          {% if forloop.index > 3 %}
             <div class="header__nav-item">
               <a href="{{ link.url }}" class="header__nav-link">{{ link.title }}</a>
               {% if link.links != blank %}
                <div class="mega-menu">
                  <div class="mega-menu__wrapper">
                    <div class="mega-menu__cols">
                      {% for childlink in link.links %}
                        <div class="mega-menu__col">
                          <a href="{{ childlink.url }}" class="mega-menu__heading">{{ childlink.title }}</a>
                          <ul class="mega-menu__list">
                            {% for grandchild in childlink.links %}
                              <li><a href="{{ grandchild.url }}" class="mega-menu__sublink">{{ grandchild.title }}</a></li>
                            {% endfor %}
                          </ul>
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                </div>
               {% endif %}
             </div>
          {% endif %}
        {% endfor %}
      </nav>
      
      <a href="{{ routes.search_url }}" class="header__text-link">{{ 'general.header.search' | t }}</a>
      <button class="header__text-link" data-login-drawer-open>{{ 'general.header.login' | t }}</button>
      <button class="header__text-link header__text-link--bag" data-cart-drawer-open>
        {{ 'general.header.bag' | t }}
        <span class="header__cart-count" data-cart-count>{{ cart.item_count }}</span>
      </button>
      <button class="header__mobile-toggle" data-mobile-menu-toggle><span></span><span></span><span></span></button>
    </div>
  </div>
</header>

<div class="mobile-menu" data-mobile-menu>
  <nav class="mobile-menu__nav">
    {% for link in linklists.main-menu.links %}
      <a href="{{ link.url }}" class="mobile-menu__link">{{ link.title }}</a>
    {% endfor %}
  </nav>
  <div class="mobile-menu__icons">
    <a href="{{ routes.search_url }}" class="mobile-menu__icon-link">{{ 'general.header.search' | t }}</a>
    <button class="mobile-menu__icon-link" data-login-drawer-open>{{ 'general.header.login' | t }}</button>
  </div>
</div>

{% schema %}
{ "name": "Header", "class": "section-header", "settings": [] }
{% endschema %}